# ğŸ¤ Q03. ë©€í‹°ìŠ¤ë ˆë“œì— ëŒ€í•´ì„œ ì„¤ëª…í•´ ì£¼ì„¸ìš”.

> - ìŠ¤ë ˆë“œëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ë™ì‘ì˜ ë‹¨ìœ„ì´ê³ , ë©€í‹°ìŠ¤ë ˆë“œëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ì—¬ëŸ¬ ê°œì˜ ì¼ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ê²ƒì…ë‹ˆë‹¤.
> - ì¦‰, í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ ì‘ì—…ì„ ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ë©€í‹°ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
> - ë©€í‹°ìŠ¤ë ˆë“œì˜ ê° ìŠ¤ë ˆë“œëŠ” ìŠ¤íƒ ë©”ëª¨ë¦¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì˜ì—­(code, data, heap) ì˜ì—­ì„ ê³µìœ í•©ë‹ˆë‹¤.

<br/>

# ğŸ¤ Q03-1. ìŠ¤ë ˆë“œëŠ” ì™œ ë…ë¦½ì ì¸ ìŠ¤íƒ ë©”ëª¨ë¦¬ ì˜ì—­ì´ í•„ìš”í•œê°€ìš”?

> - ìŠ¤íƒ ì˜ì—­ì€ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ì „ë‹¬ë˜ëŠ” ì¸ì, í•¨ìˆ˜ì˜ return address, í•¨ìˆ˜ ë‚´ ì§€ì—­ë³€ìˆ˜ ë“±ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ë©”ëª¨ë¦¬ ì˜ì—­ì…ë‹ˆë‹¤.
> - ìŠ¤ë ˆë“œê°€ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ë…ë¦½ì ì¸ ê¸°ëŠ¥ì„ í•œë‹¤ëŠ” ê²ƒì€ ë…ë¦½ì ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.
> - ë”°ë¼ì„œ, ê° ìŠ¤ë ˆë“œê°€ ë…ë¦½ì ì¸ ë™ì‘ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ê° ìŠ¤ë ˆë“œì˜ ìŠ¤íƒ ë©”ëª¨ë¦¬ ì˜ì—­ì´ ë…ë¦½ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

<br/>

## ğŸ–‹ï¸ ìŠ¤íƒ ë©”ëª¨ë¦¬ì™€ PC ë ˆì§€ìŠ¤í„°

- ìŠ¤ë ˆë“œê°€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” ì¸ì ì „ë‹¬, return address ì €ì¥, í•¨ìˆ˜ ë‚´ ì§€ì—­ ë³€ìˆ˜ ì €ì¥ ë“±ì„ ìœ„í•´ ë…ë¦½ì ì¸ ìŠ¤íƒ ë©”ëª¨ë¦¬ê°€ í•„ìš”í•˜ë‹¤.
- ë©€í‹°ìŠ¤ë ˆë“œì—ì„œëŠ” ìŠ¤ë ˆë“œë§ˆë‹¤ PC Registerë¥¼ ê°€ì§€ê³  ìˆì–´ì•¼ í•œë‹¤. í•œ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œë„ ìŠ¤ë ˆë“œë¼ë¦¬ ë¬¸ë§¥ êµí™˜ì´ ë°œìƒí•˜ëŠ”ë°, PC registerì— ì£¼ì†Œê°€ ì €ì¥ë˜ì–´ ìˆì–´ì•¼ ì´ì–´ì„œ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.

<p align="center">
    <img src="/ìš´ì˜ì²´ì œ/jaeseok/img/thread_stack_memory.png" width="600"/>
</p>

<br/>

## ğŸ–‹ï¸ ìë°”ì—ì„œ ìŠ¤ë ˆë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•

### 1. Thread í´ë˜ìŠ¤ ìƒì†

ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³ , `Thread` í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ `run` ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•œë‹¤.

```java
// Thread í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œ í´ë˜ìŠ¤ë¥¼ ì •ì˜
public class MyThread extends Thread {

    public static void main(String[] args) {
        MyThread thread1 = new MyThread("Thread 1");
        MyThread thread2 = new MyThread("Thread 2");

        thread1.start(); // ìŠ¤ë ˆë“œ ì‹œì‘
        thread2.start(); // ìŠ¤ë ˆë“œ ì‹œì‘
    }

    private final String threadName;

    public MyThread(String name) {
        this.threadName = name;
    }

    // run ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ìŠ¤ë ˆë“œì˜ ì‘ì—… ì •ì˜
    @Override
    public void run() {
        for (int i = 0; i < 5; i++) {
            System.out.println(threadName + " running: " + i);
            try {
                Thread.sleep(1000); // 1ì´ˆ ë™ì•ˆ ëŒ€ê¸°
            } catch (InterruptedException e) {
                System.out.println(threadName + " interrupted.");
            }
        }
        System.out.println(threadName + " exiting.");
    }
}
```
```
Thread 1 running: 0
Thread 2 running: 0
Thread 2 running: 1
Thread 1 running: 1
Thread 2 running: 2
Thread 1 running: 2
Thread 2 running: 3
Thread 1 running: 3
Thread 2 running: 4
Thread 1 running: 4
Thread 2 exiting.
Thread 1 exiting.

Process finished with exit code 0
```

### 2. Runnable ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³  `run`ë©”ì„œë“œë¥¼ ì •ì˜í•œ í›„, ì´ë¥¼ `Thread` ê°ì²´ ì „ë‹¬í•œë‹¤.

```java
// Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œ í´ë˜ìŠ¤ë¥¼ ì •ì˜
public class MyRunnable implements Runnable {
    public static void main(String[] args) {
        MyRunnable runnable1 = new MyRunnable("Runnable 1");
        MyRunnable runnable2 = new MyRunnable("Runnable 2");

        Thread thread1 = new Thread(runnable1);
        Thread thread2 = new Thread(runnable2);

        thread1.start(); // ìŠ¤ë ˆë“œ ì‹œì‘
        thread2.start(); // ìŠ¤ë ˆë“œ ì‹œì‘
    }

    private final String threadName;

    public MyRunnable(String name) {
        this.threadName = name;
    }

    // run ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ì—¬ ìŠ¤ë ˆë“œì˜ ì‘ì—… ì •ì˜
    @Override
    public void run() {
        for (int i = 0; i < 5; i++) {
            System.out.println(threadName + " running: " + i);
            try {
                Thread.sleep(1000); // 1ì´ˆ ë™ì•ˆ ëŒ€ê¸°
            } catch (InterruptedException e) {
                System.out.println(threadName + " interrupted.");
            }
        }
        System.out.println(threadName + " exiting.");
    }
}
```
```
Thread 1 running: 0
Thread 2 running: 0
Thread 1 running: 1
Thread 2 running: 1
Thread 1 running: 2
Thread 2 running: 2
Thread 1 running: 3
Thread 2 running: 3
Thread 1 running: 4
Thread 2 running: 4
Thread 1 exiting.
Thread 2 exiting.

Process finished with exit code 0
```

<br/>

## ğŸ–‹ï¸ ìë°”ì—ì„œ ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë©”ëª¨ë¦¬ ê³µìœ ì™€ ë™ê¸°í™”

ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ê° ìŠ¤ë ˆë“œëŠ” ìŠ¤íƒ ë©”ëª¨ë¦¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê³µìœ í•  ìˆ˜ ìˆë‹¤.

### ìŠ¤íƒ ë©”ëª¨ë¦¬

- ê° ìŠ¤ë ˆë“œëŠ” ìì‹ ë§Œì˜ ìŠ¤íƒ ë©”ëª¨ë¦¬ë¥¼ ê°€ì§„ë‹¤.
- ì´ ìŠ¤íƒì—ëŠ” ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ í•„ìš”í•œ ì§€ì—­ ë³€ìˆ˜ì™€ í•¨ìˆ˜ í˜¸ì¶œì´ ì €ì¥ëœë‹¤.
- ë‹¤ë¥¸ ìŠ¤ë ˆë“œì™€ ê³µìœ ë˜ì§€ ì•ŠìŒ.

### í™ ë©”ëª¨ë¦¬

- ìŠ¤ë ˆë“œë“¤ì€ í™ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•œë‹¤.
- í™ ë©”ëª¨ë¦¬ì—ëŠ” ê°ì²´ì™€ í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ì €ì¥ëœë‹¤.
- ì—¬ëŸ¬ ìŠ¤ë ˆë“œëŠ” ë™ì‹œì— í™ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤. -> ë™ì‹œì„± ë¬¸ì œ ë°œìƒ ê°€ëŠ¥

### ë™ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜

1. `synchronized` í‚¤ì›Œë“œ

`synchronized` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ìŠ¤ë ˆë“œê°€ ë©”ì„œë“œ ë˜ëŠ” ë¸”ëŸ­ì„ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ í•´ë‹¹ ë©”ì„œë“œ ë˜ëŠ” ë¸”ëŸ­ì— ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ì„ ìˆ˜ ìˆë‹¤.

```java
public class Counter {
    private int count = 0;

    public synchronized void increment() {
        count++;
    }

    public synchronized int getCount() {
        return count;
    }
}
```

2. Lock ì¸í„°í˜ì´ìŠ¤

Lock ì¸í„°í˜ì´ìŠ¤ëŠ” ëª…ì‹œì ìœ¼ë¡œ lockì„ íšë“í•˜ê±°ë‚˜ í•´ì œí•˜ëŠ” ë©”ì„œë“œë¥¼ ì œê³µí•˜ì—¬ ë™ì‹œì„±ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤.

```java
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class Counter {
    private final Lock lock = new ReentrantLock();
    private int count = 0;

    public void increment() {
        lock.lock();
        try {
            count++;
        } finally {
            lock.unlock();
        }
    }

    public int getCount() {
        return count;
    }
}
```